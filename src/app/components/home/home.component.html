<div class="container d-flex flex-column gap-5 align-items-center">

    <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel" style="margin-top: 50px;">
        <div class="carousel-inner">
            <div class="carousel-item active" data-bs-interval="3000">
                <img src="https://res.cloudinary.com/ddio1oisb/image/upload/v1707880170/Cover_default_nbahdp.jpg"
                    class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item" data-bs-interval="3000">
                <img src="https://res.cloudinary.com/ddio1oisb/image/upload/v1707881068/ahqztf6jnxuldcw4wi39.png"
                    class="d-block w-100" alt="...">
            </div>
        </div>
    </div>


    <div class="d-flex flex-column align-items-center" style="color: orange;">
        <h1>¿Qué estas buscando?</h1>
        
        <div class="buttons d-flex gap-5 shadow-sm p-4 bg-body-tertiary rounded">
            <button class="btn btn-outline-dark" *ngIf="(auth.isGrocer() | async) || !(auth.isLoggedIn() | async)"
                (click)="viewCompanies()"> Encontrar Empresas <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                  </svg></button>
            <button class="btn btn-outline-dark" *ngIf="(auth.isGrocer() | async) || !(auth.isLoggedIn() | async)"
                (click)="viewProducts()">Encontrar Productos <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-archive-fill" viewBox="0 0 16 16">
                    <path d="M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1M.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8z"/>
                  </svg></button>
            <button class="btn btn-outline-dark" *ngIf="(auth.isGrocer() | async) || !(auth.isLoggedIn() | async)"
                (click)="createOrder()">Crear pedido <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-check-fill" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0m-.646 5.354a.5.5 0 0 0-.708-.708L7.5 10.793 6.354 9.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0z"/>
                  </svg></button>
            <button class="btn btn-outline-dark" *ngIf="(auth.isGrocer() | async) || !(auth.isLoggedIn() | async)"
                (click)="viewOrders()">Ver pedidos <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
                    <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
                  </svg></button>
        </div>

    </div>

    <div class="col-md-6 d-flex gap-3 flex-xxl-column flex-wrap" style="width: 60%;"
        *ngIf="publicaciones; else noPublications">
        <div class="card" style="width: 100%; height: 100%;" *ngFor="let publicacion of publicaciones; let i = index">
            <div class="card-header d-flex align-items-center gap-4">
                <img (click)="viewProfile(publicacion.nit_company)" style="cursor: pointer;" appBrokenImageProfile
                    [imageType]="'photo'" [src]="newDataPub[i]?.profile_photo" [alt]="newDataPub[i]?.name_company"
                    width="50px" height="50px">
                <div class="row">
                    <p (click)="viewProfile(publicacion.nit_company)"
                        style="cursor: pointer; padding: 0; margin: 0; font-size: 20px;">{{ newDataPub[i]?.name_company
                        }}</p>
                    <p style="cursor: pointer; padding: 0; margin: 0;">{{ publicacion.date | date }} </p>
                </div>
            </div>
            <div class="card-body w-100 d-flex justify-content-center flex-column">
                <p class="fs-3 bg-light" style="color: black">{{ publicacion.text }}</p>
                <img src="{{ publicacion.secure_url }}" class="img-fluid" style="cursor: pointer;"
                    data-bs-toggle="modal" [attr.data-bs-target]="'#imageModal_' + i">
            </div>
        </div>
    </div>
    <div class="finishedMessage" *ngIf="finish">
        <div class="d-flex justify-content-center">
            <p style="text-align: center;">No hay más publicaciones por mostrar</p>
        </div>
    </div>
</div>

<ng-template #noPublications>
    <p>No hay publicaciones por mostrar</p>
</ng-template>

<!-- Modals -->
<div *ngFor="let publicacion of publicaciones; let i = index" class="modal fade" [id]="'imageModal_' + i" tabindex="-1"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{ publicacion.text }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body img-modal-body">
                <img src="{{ publicacion.secure_url }}" class="img-fluid">
            </div>
        </div>
    </div>
</div>
